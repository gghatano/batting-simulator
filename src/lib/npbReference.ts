// ---------------------------------------------------------------------------
// npbReference.ts — NPB historical team runs-per-game data (2000–2025)
// Source: https://npb.jp/bis/yearly/{league}_{year}.html
// rpg = total runs / games played
// ---------------------------------------------------------------------------

export interface NpbTeamSeason {
  year: number;
  team: string;
  rpg: number;
}

/** NPB team scoring data (2000–2025, all 12 teams per year) */
export const npbReference: NpbTeamSeason[] = [
  // 2025
  { year: 2025, team: '中日', rpg: 2.82 },
  { year: 2025, team: '西武', rpg: 2.87 },
  { year: 2025, team: 'ロッテ', rpg: 3.08 },
  { year: 2025, team: '広島', rpg: 3.08 },
  { year: 2025, team: '楽天', rpg: 3.12 },
  { year: 2025, team: 'ヤクルト', rpg: 3.10 },
  { year: 2025, team: '巨人', rpg: 3.24 },
  { year: 2025, team: '阪神', rpg: 3.47 },
  { year: 2025, team: 'オリックス', rpg: 3.51 },
  { year: 2025, team: 'DeNA', rpg: 3.57 },
  { year: 2025, team: '日本ハム', rpg: 3.83 },
  { year: 2025, team: 'ソフトバンク', rpg: 3.85 },
  // 2024
  { year: 2024, team: '西武', rpg: 2.45 },
  { year: 2024, team: '中日', rpg: 2.61 },
  { year: 2024, team: 'オリックス', rpg: 2.81 },
  { year: 2024, team: '広島', rpg: 2.90 },
  { year: 2024, team: '阪神', rpg: 3.39 },
  { year: 2024, team: '楽天', rpg: 3.44 },
  { year: 2024, team: 'ロッテ', rpg: 3.45 },
  { year: 2024, team: 'ヤクルト', rpg: 3.54 },
  { year: 2024, team: 'DeNA', rpg: 3.65 },
  { year: 2024, team: '日本ハム', rpg: 3.72 },
  { year: 2024, team: '巨人', rpg: 3.23 },
  { year: 2024, team: 'ソフトバンク', rpg: 4.24 },
  // 2023
  { year: 2023, team: '中日', rpg: 2.73 },
  { year: 2023, team: '西武', rpg: 3.04 },
  { year: 2023, team: '日本ハム', rpg: 3.24 },
  { year: 2023, team: '広島', rpg: 3.45 },
  { year: 2023, team: 'ロッテ', rpg: 3.53 },
  { year: 2023, team: 'オリックス', rpg: 3.55 },
  { year: 2023, team: '楽天', rpg: 3.59 },
  { year: 2023, team: 'DeNA', rpg: 3.64 },
  { year: 2023, team: '巨人', rpg: 3.66 },
  { year: 2023, team: 'ヤクルト', rpg: 3.73 },
  { year: 2023, team: 'ソフトバンク', rpg: 3.75 },
  { year: 2023, team: '阪神', rpg: 3.88 },
  // 2022
  { year: 2022, team: '中日', rpg: 2.90 },
  { year: 2022, team: '日本ハム', rpg: 3.24 },
  { year: 2022, team: '西武', rpg: 3.24 },
  { year: 2022, team: '阪神', rpg: 3.42 },
  { year: 2022, team: 'オリックス', rpg: 3.43 },
  { year: 2022, team: 'DeNA', rpg: 3.47 },
  { year: 2022, team: 'ロッテ', rpg: 3.50 },
  { year: 2022, team: '楽天', rpg: 3.73 },
  { year: 2022, team: '巨人', rpg: 3.83 },
  { year: 2022, team: '広島', rpg: 3.86 },
  { year: 2022, team: 'ソフトバンク', rpg: 3.88 },
  { year: 2022, team: 'ヤクルト', rpg: 4.33 },
  // 2021
  { year: 2021, team: '中日', rpg: 2.83 },
  { year: 2021, team: '日本ハム', rpg: 3.17 },
  { year: 2021, team: '西武', rpg: 3.64 },
  { year: 2021, team: '楽天', rpg: 3.72 },
  { year: 2021, team: '阪神', rpg: 3.78 },
  { year: 2021, team: 'オリックス', rpg: 3.85 },
  { year: 2021, team: '巨人', rpg: 3.86 },
  { year: 2021, team: '広島', rpg: 3.90 },
  { year: 2021, team: 'DeNA', rpg: 3.91 },
  { year: 2021, team: 'ソフトバンク', rpg: 3.94 },
  { year: 2021, team: 'ロッテ', rpg: 4.08 },
  { year: 2021, team: 'ヤクルト', rpg: 4.37 },
  // 2020 (120 games due to COVID)
  { year: 2020, team: '中日', rpg: 3.58 },
  { year: 2020, team: 'オリックス', rpg: 3.68 },
  { year: 2020, team: 'ロッテ', rpg: 3.84 },
  { year: 2020, team: 'ヤクルト', rpg: 3.90 },
  { year: 2020, team: '西武', rpg: 3.99 },
  { year: 2020, team: '日本ハム', rpg: 4.11 },
  { year: 2020, team: '阪神', rpg: 4.12 },
  { year: 2020, team: 'DeNA', rpg: 4.30 },
  { year: 2020, team: '広島', rpg: 4.36 },
  { year: 2020, team: '巨人', rpg: 4.43 },
  { year: 2020, team: 'ソフトバンク', rpg: 4.43 },
  { year: 2020, team: '楽天', rpg: 4.64 },
  // 2019
  { year: 2019, team: '阪神', rpg: 3.76 },
  { year: 2019, team: 'オリックス', rpg: 3.80 },
  { year: 2019, team: '日本ハム', rpg: 3.92 },
  { year: 2019, team: '中日', rpg: 3.94 },
  { year: 2019, team: 'ソフトバンク', rpg: 4.07 },
  { year: 2019, team: '広島', rpg: 4.13 },
  { year: 2019, team: 'DeNA', rpg: 4.17 },
  { year: 2019, team: '楽天', rpg: 4.29 },
  { year: 2019, team: 'ロッテ', rpg: 4.49 },
  { year: 2019, team: 'ヤクルト', rpg: 4.59 },
  { year: 2019, team: '巨人', rpg: 4.64 },
  { year: 2019, team: '西武', rpg: 5.29 },
  // 2018
  { year: 2018, team: '楽天', rpg: 3.64 },
  { year: 2018, team: 'ロッテ', rpg: 3.73 },
  { year: 2018, team: 'オリックス', rpg: 3.76 },
  { year: 2018, team: 'DeNA', rpg: 4.00 },
  { year: 2018, team: '阪神', rpg: 4.04 },
  { year: 2018, team: '日本ハム', rpg: 4.12 },
  { year: 2018, team: '中日', rpg: 4.18 },
  { year: 2018, team: '巨人', rpg: 4.37 },
  { year: 2018, team: 'ヤクルト', rpg: 4.60 },
  { year: 2018, team: 'ソフトバンク', rpg: 4.79 },
  { year: 2018, team: '広島', rpg: 5.04 },
  { year: 2018, team: '西武', rpg: 5.54 },
  // 2017
  { year: 2017, team: 'ヤクルト', rpg: 3.31 },
  { year: 2017, team: 'ロッテ', rpg: 3.35 },
  { year: 2017, team: '中日', rpg: 3.41 },
  { year: 2017, team: '日本ハム', rpg: 3.56 },
  { year: 2017, team: '巨人', rpg: 3.75 },
  { year: 2017, team: 'オリックス', rpg: 3.77 },
  { year: 2017, team: '楽天', rpg: 4.09 },
  { year: 2017, team: '阪神', rpg: 4.12 },
  { year: 2017, team: 'DeNA', rpg: 4.17 },
  { year: 2017, team: 'ソフトバンク', rpg: 4.46 },
  { year: 2017, team: '西武', rpg: 4.83 },
  { year: 2017, team: '広島', rpg: 5.15 },
  // 2016
  { year: 2016, team: '中日', rpg: 3.50 },
  { year: 2016, team: 'オリックス', rpg: 3.49 },
  { year: 2016, team: '阪神', rpg: 3.54 },
  { year: 2016, team: '巨人', rpg: 3.63 },
  { year: 2016, team: '楽天', rpg: 3.80 },
  { year: 2016, team: 'DeNA', rpg: 4.00 },
  { year: 2016, team: 'ロッテ', rpg: 4.08 },
  { year: 2016, team: 'ヤクルト', rpg: 4.15 },
  { year: 2016, team: '日本ハム', rpg: 4.33 },
  { year: 2016, team: '西武', rpg: 4.33 },
  { year: 2016, team: 'ソフトバンク', rpg: 4.45 },
  { year: 2016, team: '広島', rpg: 4.78 },
  // 2015
  { year: 2015, team: '楽天', rpg: 3.24 },
  { year: 2015, team: '阪神', rpg: 3.25 },
  { year: 2015, team: '中日', rpg: 3.31 },
  { year: 2015, team: '巨人', rpg: 3.42 },
  { year: 2015, team: '広島', rpg: 3.54 },
  { year: 2015, team: 'DeNA', rpg: 3.55 },
  { year: 2015, team: 'オリックス', rpg: 3.63 },
  { year: 2015, team: 'ロッテ', rpg: 3.92 },
  { year: 2015, team: 'ヤクルト', rpg: 4.01 },
  { year: 2015, team: '日本ハム', rpg: 4.30 },
  { year: 2015, team: '西武', rpg: 4.41 },
  { year: 2015, team: 'ソフトバンク', rpg: 4.55 },
  // 2014
  { year: 2014, team: '楽天', rpg: 3.81 },
  { year: 2014, team: 'ロッテ', rpg: 3.86 },
  { year: 2014, team: 'DeNA', rpg: 3.94 },
  { year: 2014, team: '中日', rpg: 3.96 },
  { year: 2014, team: '西武', rpg: 3.99 },
  { year: 2014, team: 'オリックス', rpg: 4.06 },
  { year: 2014, team: '日本ハム', rpg: 4.12 },
  { year: 2014, team: '巨人', rpg: 4.14 },
  { year: 2014, team: '阪神', rpg: 4.16 },
  { year: 2014, team: 'ソフトバンク', rpg: 4.22 },
  { year: 2014, team: '広島', rpg: 4.51 },
  { year: 2014, team: 'ヤクルト', rpg: 4.63 },
  // 2013
  { year: 2013, team: 'オリックス', rpg: 3.56 },
  { year: 2013, team: '中日', rpg: 3.65 },
  { year: 2013, team: '阪神', rpg: 3.69 },
  { year: 2013, team: '日本ハム', rpg: 3.71 },
  { year: 2013, team: '広島', rpg: 3.87 },
  { year: 2013, team: '西武', rpg: 3.96 },
  { year: 2013, team: 'ロッテ', rpg: 3.97 },
  { year: 2013, team: 'ヤクルト', rpg: 4.01 },
  { year: 2013, team: '巨人', rpg: 4.15 },
  { year: 2013, team: '楽天', rpg: 4.36 },
  { year: 2013, team: 'DeNA', rpg: 4.38 },
  { year: 2013, team: 'ソフトバンク', rpg: 4.58 },
  // 2012
  { year: 2012, team: '阪神', rpg: 2.85 },
  { year: 2012, team: 'DeNA', rpg: 2.93 },
  { year: 2012, team: '中日', rpg: 2.94 },
  { year: 2012, team: '広島', rpg: 2.97 },
  { year: 2012, team: 'オリックス', rpg: 3.08 },
  { year: 2012, team: 'ソフトバンク', rpg: 3.14 },
  { year: 2012, team: '楽天', rpg: 3.41 },
  { year: 2012, team: 'ヤクルト', rpg: 3.47 },
  { year: 2012, team: 'ロッテ', rpg: 3.47 },
  { year: 2012, team: '日本ハム', rpg: 3.54 },
  { year: 2012, team: '西武', rpg: 3.58 },
  { year: 2012, team: '巨人', rpg: 3.71 },
  // 2011
  { year: 2011, team: '中日', rpg: 2.91 },
  { year: 2011, team: '横浜', rpg: 2.94 },
  { year: 2011, team: '楽天', rpg: 3.00 },
  { year: 2011, team: 'ロッテ', rpg: 3.00 },
  { year: 2011, team: '広島', rpg: 3.05 },
  { year: 2011, team: '巨人', rpg: 3.27 },
  { year: 2011, team: 'オリックス', rpg: 3.32 },
  { year: 2011, team: '阪神', rpg: 3.35 },
  { year: 2011, team: '日本ハム', rpg: 3.35 },
  { year: 2011, team: 'ヤクルト', rpg: 3.36 },
  { year: 2011, team: 'ソフトバンク', rpg: 3.82 },
  { year: 2011, team: '西武', rpg: 3.97 },
  // 2010
  { year: 2010, team: '横浜', rpg: 3.62 },
  { year: 2010, team: '中日', rpg: 3.74 },
  { year: 2010, team: '楽天', rpg: 4.00 },
  { year: 2010, team: '広島', rpg: 4.14 },
  { year: 2010, team: '日本ハム', rpg: 4.25 },
  { year: 2010, team: 'ヤクルト', rpg: 4.28 },
  { year: 2010, team: 'ソフトバンク', rpg: 4.43 },
  { year: 2010, team: 'オリックス', rpg: 4.47 },
  { year: 2010, team: '西武', rpg: 4.72 },
  { year: 2010, team: 'ロッテ', rpg: 4.92 },
  { year: 2010, team: '巨人', rpg: 4.94 },
  { year: 2010, team: '阪神', rpg: 5.14 },
  // 2005
  { year: 2005, team: '楽天', rpg: 3.71 },
  { year: 2005, team: 'オリックス', rpg: 3.87 },
  { year: 2005, team: 'ヤクルト', rpg: 4.05 },
  { year: 2005, team: '広島', rpg: 4.21 },
  { year: 2005, team: '巨人', rpg: 4.23 },
  { year: 2005, team: '横浜', rpg: 4.25 },
  { year: 2005, team: '西武', rpg: 4.44 },
  { year: 2005, team: '日本ハム', rpg: 4.45 },
  { year: 2005, team: '中日', rpg: 4.66 },
  { year: 2005, team: 'ソフトバンク', rpg: 4.84 },
  { year: 2005, team: '阪神', rpg: 5.01 },
  { year: 2005, team: 'ロッテ', rpg: 5.44 },
  // 2004
  { year: 2004, team: 'ヤクルト', rpg: 4.48 },
  { year: 2004, team: '中日', rpg: 4.51 },
  { year: 2004, team: 'DeNA', rpg: 4.64 },
  { year: 2004, team: '阪神', rpg: 4.62 },
  { year: 2004, team: '広島', rpg: 4.80 },
  { year: 2004, team: '巨人', rpg: 5.35 },
  { year: 2004, team: 'オリックス', rpg: 4.68 },
  { year: 2004, team: '近鉄', rpg: 4.74 },
  { year: 2004, team: 'ロッテ', rpg: 4.88 },
  { year: 2004, team: 'ダイエー', rpg: 5.56 },
  { year: 2004, team: '西武', rpg: 5.40 },
  { year: 2004, team: '日本ハム', rpg: 5.50 },
  // 2003
  { year: 2003, team: '横浜', rpg: 4.02 },
  { year: 2003, team: '広島', rpg: 3.99 },
  { year: 2003, team: '中日', rpg: 4.40 },
  { year: 2003, team: '巨人', rpg: 4.67 },
  { year: 2003, team: 'ヤクルト', rpg: 4.88 },
  { year: 2003, team: '阪神', rpg: 5.20 },
  { year: 2003, team: 'ロッテ', rpg: 4.65 },
  { year: 2003, team: 'オリックス', rpg: 4.66 },
  { year: 2003, team: '日本ハム', rpg: 4.82 },
  { year: 2003, team: '西武', rpg: 4.94 },
  { year: 2003, team: '近鉄', rpg: 5.13 },
  { year: 2003, team: 'ダイエー', rpg: 5.87 },
  // 2002
  { year: 2002, team: '横浜', rpg: 3.37 },
  { year: 2002, team: '阪神', rpg: 3.76 },
  { year: 2002, team: '広島', rpg: 3.88 },
  { year: 2002, team: '中日', rpg: 3.90 },
  { year: 2002, team: 'ヤクルト', rpg: 3.96 },
  { year: 2002, team: '巨人', rpg: 4.94 },
  { year: 2002, team: 'オリックス', rpg: 3.13 },
  { year: 2002, team: 'ロッテ', rpg: 3.57 },
  { year: 2002, team: '日本ハム', rpg: 3.61 },
  { year: 2002, team: '近鉄', rpg: 4.27 },
  { year: 2002, team: 'ダイエー', rpg: 4.50 },
  { year: 2002, team: '西武', rpg: 4.80 },
  // 2001
  { year: 2001, team: '阪神', rpg: 3.34 },
  { year: 2001, team: '中日', rpg: 3.45 },
  { year: 2001, team: '横浜', rpg: 4.00 },
  { year: 2001, team: '広島', rpg: 4.42 },
  { year: 2001, team: 'ヤクルト', rpg: 4.61 },
  { year: 2001, team: '巨人', rpg: 4.91 },
  { year: 2001, team: '日本ハム', rpg: 4.24 },
  { year: 2001, team: 'ロッテ', rpg: 4.24 },
  { year: 2001, team: '西武', rpg: 4.43 },
  { year: 2001, team: 'オリックス', rpg: 4.65 },
  { year: 2001, team: 'ダイエー', rpg: 5.29 },
  { year: 2001, team: '近鉄', rpg: 5.50 },
  // 2000
  { year: 2000, team: '阪神', rpg: 3.48 },
  { year: 2000, team: '中日', rpg: 4.03 },
  { year: 2000, team: '横浜', rpg: 4.24 },
  { year: 2000, team: 'ヤクルト', rpg: 4.27 },
  { year: 2000, team: '広島', rpg: 4.35 },
  { year: 2000, team: '巨人', rpg: 5.10 },
  { year: 2000, team: '近鉄', rpg: 4.53 },
  { year: 2000, team: '西武', rpg: 4.55 },
  { year: 2000, team: 'ロッテ', rpg: 4.61 },
  { year: 2000, team: 'ダイエー', rpg: 4.67 },
  { year: 2000, team: 'オリックス', rpg: 4.73 },
  { year: 2000, team: '日本ハム', rpg: 5.71 },
  // 2009
  { year: 2009, team: '横浜', rpg: 3.45 },
  { year: 2009, team: '広島', rpg: 3.67 },
  { year: 2009, team: '阪神', rpg: 3.81 },
  { year: 2009, team: 'ヤクルト', rpg: 3.81 },
  { year: 2009, team: '中日', rpg: 4.20 },
  { year: 2009, team: '巨人', rpg: 4.51 },
  { year: 2009, team: 'オリックス', rpg: 4.06 },
  { year: 2009, team: '楽天', rpg: 4.15 },
  { year: 2009, team: 'ソフトバンク', rpg: 4.17 },
  { year: 2009, team: 'ロッテ', rpg: 4.31 },
  { year: 2009, team: '西武', rpg: 4.61 },
  { year: 2009, team: '日本ハム', rpg: 4.78 },
  // 2008
  { year: 2008, team: '中日', rpg: 3.72 },
  { year: 2008, team: '広島', rpg: 3.73 },
  { year: 2008, team: '日本ハム', rpg: 3.70 },
  { year: 2008, team: 'ソフトバンク', rpg: 3.86 },
  { year: 2008, team: '横浜', rpg: 3.83 },
  { year: 2008, team: '阪神', rpg: 4.01 },
  { year: 2008, team: 'ヤクルト', rpg: 4.05 },
  { year: 2008, team: '楽天', rpg: 4.35 },
  { year: 2008, team: '巨人', rpg: 4.38 },
  { year: 2008, team: 'オリックス', rpg: 4.42 },
  { year: 2008, team: 'ロッテ', rpg: 4.60 },
  { year: 2008, team: '西武', rpg: 4.97 },
  // 2007
  { year: 2007, team: '阪神', rpg: 3.60 },
  { year: 2007, team: '日本ハム', rpg: 3.65 },
  { year: 2007, team: 'オリックス', rpg: 3.72 },
  { year: 2007, team: '西武', rpg: 3.92 },
  { year: 2007, team: '横浜', rpg: 3.95 },
  { year: 2007, team: 'ソフトバンク', rpg: 3.99 },
  { year: 2007, team: '広島', rpg: 3.87 },
  { year: 2007, team: '楽天', rpg: 3.99 },
  { year: 2007, team: 'ヤクルト', rpg: 4.14 },
  { year: 2007, team: '中日', rpg: 4.33 },
  { year: 2007, team: 'ロッテ', rpg: 4.37 },
  { year: 2007, team: '巨人', rpg: 4.81 },
  // 2006
  { year: 2006, team: '楽天', rpg: 3.32 },
  { year: 2006, team: 'ロッテ', rpg: 3.69 },
  { year: 2006, team: 'オリックス', rpg: 3.54 },
  { year: 2006, team: '広島', rpg: 3.76 },
  { year: 2006, team: '巨人', rpg: 3.78 },
  { year: 2006, team: '横浜', rpg: 3.94 },
  { year: 2006, team: '阪神', rpg: 4.09 },
  { year: 2006, team: 'ソフトバンク', rpg: 4.07 },
  { year: 2006, team: '日本ハム', rpg: 4.17 },
  { year: 2006, team: '中日', rpg: 4.58 },
  { year: 2006, team: 'ヤクルト', rpg: 4.58 },
  { year: 2006, team: '西武', rpg: 4.74 },
];

export interface NpbBracket {
  /** Closest team at or below the given rpg (null if below all data) */
  lower: NpbTeamSeason | null;
  /** Closest team at or above the given rpg (null if above all data) */
  upper: NpbTeamSeason | null;
}

/** Sorted reference (computed once) */
const sorted = [...npbReference].sort((a, b) => a.rpg - b.rpg);

/**
 * Find the NPB teams that bracket the given rpg value:
 * - lower: closest team whose rpg <= given value
 * - upper: closest team whose rpg >= given value
 */
export function findBracketTeams(rpg: number): NpbBracket {
  let lower: NpbTeamSeason | null = null;
  let upper: NpbTeamSeason | null = null;

  for (const entry of sorted) {
    if (entry.rpg <= rpg) {
      if (lower === null || entry.rpg > lower.rpg) lower = entry;
    }
    if (entry.rpg >= rpg) {
      if (upper === null || entry.rpg < upper.rpg) {
        upper = entry;
        break; // sorted, so first match is closest
      }
    }
  }

  return { lower, upper };
}
